<?xml version="1.0" encoding="utf-8"?>
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009"
				xmlns:s="library://ns.adobe.com/flex/spark"
				xmlns:mx="library://ns.adobe.com/flex/mx"
				autoDrawBackground="true" contentBackgroundColor="#CCCCCC" initialize="itemrenderer1_initializeHandler(event)">
	<fx:Metadata>
		[Event(name="showDecorate",type="com.yzl.events.MyCustomEvent")]
		[Event(name="hideDecorate",type="com.yzl.events.MyCustomEvent")]
	</fx:Metadata>
	<s:layout>
		<s:VerticalLayout horizontalAlign="center" />
	</s:layout>
	<fx:Script>
		<![CDATA[
			import com.yzl.events.MyCustomEvent;
			import com.yzl.valueObject.DecoratorVO;
			import com.yzl.valueObject.VOName;
			
			import mx.core.DragSource;
			import mx.core.FlexGlobals;
			import mx.core.IUIComponent;
			import mx.events.FlexEvent;
			import mx.managers.DragManager;
			
			import spark.primitives.BitmapImage;
			protected function bc_mouseOverHandler(event:MouseEvent):void
			{
				/*
				var point:Point = new Point();
				point = (event.currentTarget as BorderContainer).localToGlobal(point);
				var img:Object = {imgStr:data.url,imgX:point.x,imgY:point.y,imgWidth:img1.width,imgHeight:img1.height};
				var e:MyCustomEvent = new MyCustomEvent("showDecorate",img);
				this.dispatchEvent(e);
				*/
				
				bc.setStyle("borderWeight",2);
				bc.setStyle("borderColor","0xFD5350");
				bc.setStyle("borderAlpha",1);
			}
			
			protected function bc_mouseOutHandler(event:MouseEvent):void
			{
				/*
				var img:Object = {imgStr:data.url};
				var e:MyCustomEvent = new MyCustomEvent("hideDecorate",img);
				this.dispatchEvent(e);
				*/
				
				bc.setStyle("borderWeight",1);
				bc.setStyle("borderColor","0xeeeeee");
				bc.setStyle("borderAlpha",0);
			}
			
			protected function image1_completeHandler(event:Event):void
			{
				// TODO Auto-generated method stub
				var img:Image = event.target as Image;
				
				if(img.contentHeight >img.contentWidth)
				{
					img1.height= img.contentHeight*(68/img.contentHeight);
					img1.width = img.contentWidth*(68/img.contentHeight);
				}
				else
				{
					img1.width = img.contentWidth*(68/img.contentWidth);
					img1.height= img.contentHeight*(68/img.contentWidth);
				}
				
				
			}
			
			protected function image2_clickHandle(event:MouseEvent):void
			{
				var img:DecoratorVO = data as DecoratorVO;
				var e:MyCustomEvent = new MyCustomEvent("removeDecorate",img);
				bc.removeEventListener(MouseEvent.ROLL_OVER,bc_mouseOverHandler);
				bc.removeEventListener(MouseEvent.ROLL_OUT,bc_mouseOutHandler);
				
				this.dispatchEvent(e);
			}
			
			private function dropImage(event:MouseEvent,format:String):void
			{
				var ds:DragSource = new DragSource();
				var proxy:BitmapImage = new BitmapImage();
				var imageHandle:Group = new Group();
				proxy.source = img1.content;
				
				if(img1.content.height>img1.content.width)
				{
					proxy.width = img1.content.width*(200/img1.content.height);
					proxy.height = 200;
				}
				else
				{
					proxy.height = img1.content.height*(200/img1.content.width);
					proxy.width = 200;
				}
				
				imageHandle.addElement(proxy);
				ds.addData(data,format);
				DragManager.doDrag(event.currentTarget as IUIComponent,ds,event,imageHandle,-mouseX+proxy.width/2,-mouseY+proxy.height/2);
			}
			
			protected function itemrenderer1_initializeHandler(event:FlexEvent):void
			{
				bc.setStyle("borderAlpha",0);
			}
			
		]]>
	</fx:Script>
	<s:Group>
		
	<s:BorderContainer id="bc" right="0" top="0" width="75" height="75" backgroundColor="#B3B3B3"
					   borderColor="0xeeeeee" borderVisible="true"
					   rollOut="bc_mouseOutHandler(event)" rollOver="bc_mouseOverHandler(event)"
					   toolTip="请拖动图片到设计区">
		
		<mx:Image id="img1" source="{data.thumbnailURL}" horizontalCenter="0" verticalCenter="0"
				  complete="image1_completeHandler(event)"   mouseDown="dropImage(event,VOName.DisplayObject)" />
		
	</s:BorderContainer>
		
	</s:Group>
</s:ItemRenderer>
